import { useState } from 'react';

/* ─── SVG Icon Components ─── */

const HamburgerIcon = () => (
  <svg viewBox="0 0 24 24" className="w-4.5 h-4.5" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
    <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" />
  </svg>
);

const CollapseIcon = () => (
  <svg viewBox="34 52 24 24" className="w-4.5 h-4.5" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
    <path d="M37 70V68H50V70H37ZM53.6 69L48.6 64L53.6 59L55 60.4L51.4 64L55 67.6L53.6 69ZM37 65V63H47V65H37ZM37 60V58H50V60H37Z" />
  </svg>
);

const VibelinkLogoSmall = () => (
  <svg viewBox="64 37 239 36" className="h-5 text-accent" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M99.3541 54.6771H64C64 59.3653 65.8624 63.8616 69.1775 67.1766C72.4926 70.4917 76.9888 72.3541 81.6771 72.3541C86.3653 72.3541 90.8615 70.4917 94.1766 67.1766C97.4917 63.8616 99.3541 59.3653 99.3541 54.6771Z" fill="currentColor" />
    <path d="M81.6771 54.6771C81.6771 49.9888 79.8146 45.4926 76.4996 42.1775C73.1845 38.8624 68.6883 37 64 37L64 54.6771H81.6771Z" fill="currentColor" />
    <path d="M81.6772 54.6771C81.6772 49.9888 83.5397 45.4926 86.8548 42.1775C90.1698 38.8624 94.6661 37 99.3543 37V54.6771H81.6772Z" fill="currentColor" />
    <path d="M118.391 72.3541V54.6771H100.714L100.714 72.3541H118.391Z" fill="currentColor" />
    <path d="M118.391 54.6771V37L100.714 37L100.714 54.6771H118.391Z" fill="currentColor" />
    <path d="M137.428 54.6771V37L119.75 37L119.75 54.6771H137.428Z" fill="currentColor" />
    <path d="M137.428 72.3541V54.6771H119.75L119.75 72.3541H137.428Z" fill="currentColor" />
    <path d="M137.088 54.6771C141.969 54.6771 145.926 50.7199 145.926 45.8385C145.926 40.9572 141.969 37 137.088 37C132.206 37 128.249 40.9572 128.249 45.8385C128.249 50.7199 132.206 54.6771 137.088 54.6771Z" fill="currentColor" />
    <path d="M137.088 72.3541C141.969 72.3541 145.926 68.397 145.926 63.5156C145.926 58.6342 141.969 54.6771 137.088 54.6771C132.206 54.6771 128.249 58.6342 128.249 63.5156C128.249 68.397 132.206 72.3541 137.088 72.3541Z" fill="currentColor" />
    <path d="M173.462 54.6771V37L155.785 37V54.6771H173.462Z" fill="currentColor" />
    <path d="M173.462 72.3541V54.6771H155.785V72.3541H173.462Z" fill="currentColor" />
    <path d="M156.125 54.6771C161.006 54.6771 164.963 50.7199 164.963 45.8385C164.963 40.9572 161.006 37 156.125 37C151.243 37 147.286 40.9572 147.286 45.8385C147.286 50.7199 151.243 54.6771 156.125 54.6771Z" fill="currentColor" />
    <path d="M156.125 72.3541C161.006 72.3541 164.963 68.397 164.963 63.5156C164.963 58.6342 161.006 54.6771 156.125 54.6771C151.243 54.6771 147.286 58.6342 147.286 63.5156C147.286 68.397 151.243 72.3541 156.125 72.3541Z" fill="currentColor" />
    <path d="M192.498 72.3541V54.6771H174.821L174.821 72.3541H192.498Z" fill="currentColor" />
    <path d="M192.498 54.6771V37L174.821 37L174.821 54.6771H192.498Z" fill="currentColor" />
    <path d="M192.499 72.3541C192.499 67.6659 194.361 63.1696 197.676 59.8546C200.991 56.5395 205.487 54.6771 210.176 54.6771V72.3541H192.499Z" fill="currentColor" />
    <path d="M229.213 72.3541V54.6771H211.536L211.536 72.3541H229.213Z" fill="currentColor" />
    <path d="M229.213 54.6771V37L211.536 37L211.536 54.6771H229.213Z" fill="currentColor" />
    <path d="M248.249 54.6771H230.572L230.572 72.3541H248.249V54.6771Z" fill="currentColor" />
    <path d="M248.25 54.6771H265.927V37L248.25 37V54.6771Z" fill="currentColor" />
    <path d="M248.249 54.6771C248.249 49.9888 246.387 45.4926 243.072 42.1775C239.757 38.8624 235.261 37 230.572 37L230.572 54.6771H248.249Z" fill="currentColor" />
    <path d="M248.25 54.6771C248.25 59.3654 250.112 63.8616 253.427 67.1767C256.742 70.4918 261.238 72.3541 265.927 72.3541V54.6771H248.25Z" fill="currentColor" />
    <path d="M284.963 72.3541V54.6771H267.286L267.286 72.3541H284.963Z" fill="currentColor" />
    <path d="M284.963 54.6771V37L267.286 37L267.286 54.6771H284.963Z" fill="currentColor" />
    <path d="M302.64 72.3541C302.64 67.6659 300.778 63.1696 297.463 59.8546C294.148 56.5395 289.652 54.6771 284.963 54.6771V72.3541H302.64Z" fill="currentColor" />
    <path d="M302.64 37C302.64 41.6883 300.778 46.1845 297.463 49.4996C294.148 52.8147 289.652 54.6771 284.963 54.6771V37L302.64 37Z" fill="currentColor" />
  </svg>
);

const MyFeedIcon = () => (
  <svg viewBox="34 122 24 24" className="w-4.5 h-4.5" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
    <path d="M47 130V126C47 125.717 47.096 125.479 47.288 125.287C47.479 125.096 47.717 125 48 125H54C54.283 125 54.521 125.096 54.713 125.287C54.904 125.479 55 125.717 55 126V130C55 130.283 54.904 130.521 54.713 130.713C54.521 130.904 54.283 131 54 131H48C47.717 131 47.479 130.904 47.288 130.713C47.096 130.521 47 130.283 47 130ZM37 134V126C37 125.717 37.096 125.479 37.288 125.287C37.479 125.096 37.717 125 38 125H44C44.283 125 44.521 125.096 44.713 125.287C44.904 125.479 45 125.717 45 126V134C45 134.283 44.904 134.521 44.713 134.713C44.521 134.904 44.283 135 44 135H38C37.717 135 37.479 134.904 37.288 134.713C37.096 134.521 37 134.283 37 134ZM47 142V134C47 133.717 47.096 133.479 47.288 133.288C47.479 133.096 47.717 133 48 133H54C54.283 133 54.521 133.096 54.713 133.288C54.904 133.479 55 133.717 55 134V142C55 142.283 54.904 142.521 54.713 142.712C54.521 142.904 54.283 143 54 143H48C47.717 143 47.479 142.904 47.288 142.712C47.096 142.521 47 142.283 47 142ZM37 142V138C37 137.717 37.096 137.479 37.288 137.288C37.479 137.096 37.717 137 38 137H44C44.283 137 44.521 137.096 44.713 137.288C44.904 137.479 45 137.717 45 138V142C45 142.283 44.904 142.521 44.713 142.712C44.521 142.904 44.283 143 44 143H38C37.717 143 37.479 142.904 37.288 142.712C37.096 142.521 37 142.283 37 142ZM39 133H43V127H39V133ZM49 141H53V135H49V141ZM49 129H53V127H49V129ZM39 141H43V139H39V141Z" />
  </svg>
);

const ArchiveIcon = () => (
  <svg viewBox="34 190 24 24" className="w-4.5 h-4.5" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
    <path d="M40.5 206C41.283 206 42.046 206.087 42.788 206.262C43.529 206.437 44.267 206.7 45 207.05V197.2C44.317 196.8 43.592 196.5 42.825 196.3C42.058 196.1 41.283 196 40.5 196C39.9 196 39.304 196.058 38.713 196.175C38.121 196.292 37.55 196.467 37 196.7V206.6C37.583 206.4 38.163 206.25 38.738 206.15C39.313 206.05 39.9 206 40.5 206ZM47 207.05C47.733 206.7 48.471 206.437 49.213 206.262C49.954 206.087 50.717 206 51.5 206C52.1 206 52.688 206.05 53.263 206.15C53.838 206.25 54.417 206.4 55 206.6V196.7C54.45 196.467 53.879 196.292 53.288 196.175C52.696 196.058 52.1 196 51.5 196C50.717 196 49.942 196.1 49.175 196.3C48.408 196.5 47.683 196.8 47 197.2V207.05ZM46 209.475C45.767 209.475 45.546 209.446 45.338 209.387C45.129 209.329 44.933 209.25 44.75 209.15C44.1 208.767 43.417 208.479 42.7 208.288C41.983 208.096 41.25 208 40.5 208C39.8 208 39.113 208.092 38.438 208.275C37.763 208.458 37.117 208.717 36.5 209.05C36.15 209.233 35.813 209.225 35.488 209.025C35.163 208.825 35 208.533 35 208.15V196.1C35 195.917 35.046 195.742 35.138 195.575C35.229 195.408 35.367 195.283 35.55 195.2C36.317 194.8 37.117 194.5 37.95 194.3C38.783 194.1 39.633 194 40.5 194C41.467 194 42.413 194.125 43.338 194.375C44.263 194.625 45.15 195 46 195.5C46.85 195 47.738 194.625 48.663 194.375C49.588 194.125 50.533 194 51.5 194C52.367 194 53.217 194.1 54.05 194.3C54.883 194.5 55.683 194.8 56.45 195.2C56.633 195.283 56.771 195.408 56.863 195.575C56.954 195.742 57 195.917 57 196.1V208.15C57 208.533 56.838 208.825 56.513 209.025C56.188 209.225 55.85 209.233 55.5 209.05C54.883 208.717 54.238 208.458 53.563 208.275C52.888 208.092 52.2 208 51.5 208C50.75 208 50.017 208.096 49.3 208.288C48.583 208.479 47.9 208.767 47.25 209.15C47.067 209.25 46.871 209.329 46.663 209.387C46.454 209.446 46.233 209.475 46 209.475Z" />
  </svg>
);

const AnalysisIcon = () => (
  <svg viewBox="34 258 24 24" className="w-4.5 h-4.5" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
    <path d="M39 280C38.45 280 37.979 279.804 37.588 279.413C37.196 279.021 37 278.55 37 278V264C37 263.45 37.196 262.979 37.588 262.588C37.979 262.196 38.45 262 39 262H40V260H42V262H50V260H52V262H53C53.55 262 54.021 262.196 54.413 262.588C54.804 262.979 55 263.45 55 264V278C55 278.55 54.804 279.021 54.413 279.413C54.021 279.804 53.55 280 53 280H39ZM39 278H53V268H39V278ZM39 266H53V264H39V266ZM46 272C45.717 272 45.479 271.904 45.288 271.713C45.096 271.521 45 271.283 45 271C45 270.717 45.096 270.479 45.288 270.288C45.479 270.096 45.717 270 46 270C46.283 270 46.521 270.096 46.713 270.288C46.904 270.479 47 270.717 47 271C47 271.283 46.904 271.521 46.713 271.713C46.521 271.904 46.283 272 46 272ZM42 272C41.717 272 41.479 271.904 41.288 271.713C41.096 271.521 41 271.283 41 271C41 270.717 41.096 270.479 41.288 270.288C41.479 270.096 41.717 270 42 270C42.283 270 42.521 270.096 42.713 270.288C42.904 270.479 43 270.717 43 271C43 271.283 42.904 271.521 42.713 271.713C42.521 271.904 42.283 272 42 272ZM50 272C49.717 272 49.479 271.904 49.288 271.713C49.096 271.521 49 271.283 49 271C49 270.717 49.096 270.479 49.288 270.288C49.479 270.096 49.717 270 50 270C50.283 270 50.521 270.096 50.713 270.288C50.904 270.479 51 270.717 51 271C51 271.283 50.904 271.521 50.713 271.713C50.521 271.904 50.283 272 50 272ZM46 276C45.717 276 45.479 275.904 45.288 275.713C45.096 275.521 45 275.283 45 275C45 274.717 45.096 274.479 45.288 274.288C45.479 274.096 45.717 274 46 274C46.283 274 46.521 274.096 46.713 274.288C46.904 274.479 47 274.717 47 275C47 275.283 46.904 275.521 46.713 275.713C46.521 275.904 46.283 276 46 276ZM42 276C41.717 276 41.479 275.904 41.288 275.713C41.096 275.521 41 275.283 41 275C41 274.717 41.096 274.479 41.288 274.288C41.479 274.096 41.717 274 42 274C42.283 274 42.521 274.096 42.713 274.288C42.904 274.479 43 274.717 43 275C43 275.283 42.904 275.521 42.713 275.713C42.521 275.904 42.283 276 42 276ZM50 276C49.717 276 49.479 275.904 49.288 275.713C49.096 275.521 49 275.283 49 275C49 274.717 49.096 274.479 49.288 274.288C49.479 274.096 49.717 274 50 274C50.283 274 50.521 274.096 50.713 274.288C50.904 274.479 51 274.717 51 275C51 275.283 50.904 275.521 50.713 275.713C50.521 275.904 50.283 276 50 276Z" />
  </svg>
);

const PaymentsIcon = () => (
  <svg viewBox="34 326 24 24" className="w-4.5 h-4.5" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
    <path d="M56 332V344C56 344.55 55.804 345.021 55.413 345.413C55.021 345.804 54.55 346 54 346H38C37.45 346 36.979 345.804 36.588 345.413C36.196 345.021 36 344.55 36 344V332C36 331.45 36.196 330.979 36.588 330.588C36.979 330.196 37.45 330 38 330H54C54.55 330 55.021 330.196 55.413 330.588C55.804 330.979 56 331.45 56 332ZM38 334H54V332H38V334ZM38 338V344H54V338H38Z" />
  </svg>
);

const SettingsIcon = () => (
  <svg viewBox="0 0 24 24" className="w-4.5 h-4.5" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
    <path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z" />
  </svg>
);

const LogoutIcon = () => (
  <svg viewBox="0 0 24 24" className="w-4.5 h-4.5" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
    <path d="M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z" />
  </svg>
);

/* ─── Nav Item ─── */

type NavItemProps = {
  icon: React.ReactNode;
  label: string;
  badge?: number;
  expanded: boolean;
};

const NavItem = ({ icon, label, badge, expanded }: NavItemProps) => (
  <button className="flex items-center gap-3 pl-[21px] pr-4 py-4 hover:bg-surface/50 transition-colors cursor-pointer whitespace-nowrap">
    <span className="shrink-0 text-sidebar-icon">{icon}</span>
    <span
      className={`flex-1 text-sm text-sidebar-text text-left transition-opacity duration-200 ${
        expanded ? 'opacity-100' : 'opacity-0'
      }`}
    >
      {label}
    </span>
    {badge !== undefined && (
      <span
        className={`text-sm text-sidebar-text/70 transition-opacity duration-200 ${
          expanded ? 'opacity-100' : 'opacity-0'
        }`}
      >
        {badge}
      </span>
    )}
  </button>
);

/* ─── Sidebar ─── */

const Sidebar = () => {
  const [expanded, setExpanded] = useState(false);

  return (
    <aside
      className={`fixed left-0 top-0 h-screen bg-white border-r border-black/10
        overflow-hidden transition-[width] duration-300 ease-in-out z-40
        ${expanded ? 'w-60 shadow-lg' : 'w-sidebar'}`}
      onMouseEnter={() => setExpanded(true)}
      onMouseLeave={() => setExpanded(false)}
    >
      <div className="w-60 h-full flex flex-col">
        {/* Top: Toggle + Logo + Beta Badge */}
        <div className="flex items-center gap-3 pl-[21px] h-header shrink-0">
          <button
            className={`shrink-0 cursor-pointer transition-colors ${
              expanded ? 'text-sidebar-text' : 'text-sidebar-icon'
            }`}
          >
            {expanded ? <CollapseIcon /> : <HamburgerIcon />}
          </button>
          <div
            className={`flex items-center gap-2 transition-opacity duration-200 ${
              expanded ? 'opacity-100' : 'opacity-0'
            }`}
          >
            <VibelinkLogoSmall />
            <span className="shrink-0 px-2.5 py-1 bg-purple text-white text-xs font-medium rounded-md">
              Beta
            </span>
          </div>
        </div>

        {/* Navigation */}
        <nav className="flex-1 flex flex-col">
          <NavItem icon={<MyFeedIcon />} label="My Feed" expanded={expanded} />
          <NavItem icon={<ArchiveIcon />} label="Archive" badge={10} expanded={expanded} />
          <NavItem icon={<AnalysisIcon />} label="Analysis report" expanded={expanded} />
          <NavItem icon={<PaymentsIcon />} label="Payments" expanded={expanded} />
        </nav>

        {/* Bottom: Settings + Logout + Membership */}
        <div className="flex flex-col">
          <NavItem icon={<SettingsIcon />} label="Settings" expanded={expanded} />
          <NavItem icon={<LogoutIcon />} label="Log out" expanded={expanded} />

          {/* Membership Card */}
          <div
            className={`mx-3 mt-3 mb-4 p-4 bg-surface rounded-xl transition-opacity duration-200 ${
              expanded ? 'opacity-100' : 'opacity-0'
            }`}
          >
            <div className="flex justify-between items-center mb-2">
              <span className="text-sm font-bold text-sidebar-text">Professional</span>
              <span className="text-xs text-sidebar-icon">Membership</span>
            </div>
            <div className="w-full h-1.5 bg-purple/20 rounded-full mb-2 overflow-hidden">
              <div className="h-full w-2/5 bg-purple rounded-full" />
            </div>
            <p className="text-xs text-sidebar-icon">Expires: 4 jun 2025</p>
          </div>
        </div>
      </div>
    </aside>
  );
};

export default Sidebar;
